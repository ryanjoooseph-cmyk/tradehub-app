name: agent-pr-hygiene
on:
  schedule:
    - cron: "0 * * * *"
  workflow_dispatch:
permissions:
  contents: write
  pull-requests: write
jobs:
  tidy:
    runs-on: ubuntu-latest
    steps:
      - uses: cli/gh-action@v2
      - run: |
          gh pr list --state open --json number,mergeStateStatus \
          --jq '.[] | select(.mergeStateStatus=="DIRTY") | .number' \
          | xargs -n1 -I{} gh pr close {} -d || true
